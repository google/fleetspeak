# An example fleetspeak configuration file, as needed by the fleetspeak-config
# tool.
#
# This is a text format fleetspeak.config.Config protocol buffer.
#
# Detailed docs in:
# https://github.com/google/fleetspeak/blob/master/fleetspeak/src/config/proto/fleetspeak_config/config.proto
# https://github.com/google/fleetspeak/blob/master/fleetspeak/src/components/proto/fleetspeak_components/config.proto

### Configuration name.
#
# May appear in certificates generated by the fleetspeak-config tool.

############ CHANGE ME ###############
configuration_name: "Lazy Corp"

### Server component configuration
components_config {

  ### Mysql connection string.
  #
  # See: https://github.com/go-sql-driver/mysql#dsn-data-source-name

  ############ CHANGE ME ###############
  mysql_data_source_name: "root:@tcp(127.0.0.1:3306)/db"

  ### PROXY protocol support
  #
  # Uncomment if your fleetspeak server will run behind a load balancer. The
  # load balancer must implement the PROXY protocol in order to provide
  # FS with the correct observed client IP.
  #
  # https://www.haproxy.org/download/1.8/doc/proxy-protocol.txt

  # proxy_protocol: true

  ### Basic client filtering
  #
  # If set, the server will perform a basic sanity check that the client is
  # meant for this server installation. To use, set to something specific to
  # this installation.

  # required_label: "lazy-corp"

  https_config {

    ### Listen address
    #
    # The bind address that FS server processes will listen to. Dependent on your
    # intended network configuration. Also see public_host_port, below.

    ############ CHANGE ME ###############
    listen_address: "localhost:443"
  }

  admin_config {
    ### Listen address for the admin GRPC endpoint.
    #
    # Note: this should be kept local or on an internal network, or protected
    # by a firewall. Whoever has access to this endpoint, can send messages
    # to Fleetspeak clients.

    listen_address: "localhost:9000"
  }

  ### Notification addresses
  #
  # If your installation will use multiple Fleetspeak servers and streaming
  # connections (the default) to clients, it is strongly recommended to
  # configure message notifications between servers. To do this, uncomment the
  # field below to open the notification port. The notification port is not
  # meant to be publicly accessible, but will need to be reachable from other
  # servers.
  #
  # By default, each server will guess the hostname and port to advertise to
  # other servers. To override this guess, you can set
  # notification_public_address in each individual server configuration file.

  # notification_listen_address: ":8080"
}

### Trusted certificate
#
# If this file does not exist, a certificate and key file will be created in
# the locations configured here.
#
# Clients will be configured to trust server certificates chained back to this,
# and the associated private key should be considered sensitive.
#
# The key for this certificate is only required by the configuration tool if it
# is needs to mint a new server certificate. Serious users should consider
# keeping the key offline, in an HSM, etc.

trusted_cert_file: "/etc/fleetspeak-server/ca.pem"
trusted_cert_key_file: "/etc/fleetspeak-server/ca-key.pem"

### Server certificate
#
# If this file does not exist, a certificate and key file will be created in the
# locations configured here, and signed using the trusted certificate, above.
#
# The resulting server configuration will identify itself using this key.

server_cert_file: "/etc/fleetspeak-server/server.pem"
server_cert_key_file: "/etc/fleetspeak-server/server-key.pem"

### Public server addresses
#
# The public hostnames or IP addresses through the FS servers will be visible to
# the FS clients. Dependent on your planned network configuration.
#
# The server certificate must cover these addresses. You will need to take care
# of this if you generate your own server certificates. You will need to
# regenerate any server certificate if these change.

# ########### CHANGE ME ###############
# public_host_port: "fs.lazy-corp.com:443"
# public_host_port: "10.0.0.5:443"
public_host_port: "localhost:443"

### Output files
#
# The location to write the server component configuration.
#
# The fleetspeak-config program will write this file, and it should be copied
# to every fleetspeak server in your installation.
server_component_configuration_file: "/etc/fleetspeak-server/server.components.config"

# The location to write the linux client configuration file. To use with the
# provided generic client package, copy this to
# "/etc/fleetspeak-client/configuration"
linux_client_configuration_file: "/etc/fleetspeak-server/linux.client.configuration"

# The location to write the darwin client configuration file.
darwin_client_configuration_file: "/etc/fleetspeak-server/darwin.client.configuration"

# The location to write the windows client configuration file.
windows_client_configuration_file: "/etc/fleetspeak-server/windows.client.configuration"
